# Live Response en Linux: Comandos Esenciales

Al igual que en Windows, realizar Live Response en Linux implica ejecutar comandos en el sistema vivo para recopilar información volátil antes de apagarlo o aislarlo para un análisis forense más profundo. Usa estos comandos con precaución y redirige la salida a un medio externo si es posible.

## Tabla de Comandos Comunes

| Tarea/Objetivo                      | Comando Linux                                                                | Notas / Qué Buscar                                                                                                                             |
| :---------------------------------- | :--------------------------------------------------------------------------- | :--------------------------------------------------------------------------------------------------------------------------------------------- |
| **Información del Sistema** | `uname -a`                                                                   | Info del Kernel, arquitectura, hostname. Útil para perfil Volatility.                                                                        |
|                                     | `hostname`                                                                   | Nombre del host.                                                                                                                               |
|                                     | `date`                                                                       | Fecha y hora actuales del sistema.                                                                                                              |
|                                     | `uptime`                                                                     | Tiempo de actividad del sistema, usuarios, carga media.                                                                                        |
|                                     | `cat /etc/os-release` o `lsb_release -a`                                     | Detalles de la distribución Linux (Ubuntu, CentOS, etc.).                                                                                     |
|                                     | `dmesg \| tail -n 50`                                                        | Últimos mensajes del kernel (hardware, drivers, errores).                                                                                     |
| **Procesos en Ejecución** | `ps aux` o `ps -elf`                                                         | **Fundamental:** Lista todos los procesos, usuario, PID, PPID, CPU/MEM, comando completo. Buscar procesos/usuarios sospechosos, rutas extrañas. |
|                                     | `pstree -p`                                                                  | Muestra procesos en árbol con PIDs (relaciones padre-hijo).                                                                                  |
|                                     | `top -n 1 -b` o `htop` (si existe)                                         | Vista de procesos en tiempo real (CPU/MEM). `-n 1 -b` en `top` para salida no interactiva.                                                     |
|                                     | `ls -al /proc/<PID>/exe`                                                       | Enlace simbólico al ejecutable original del proceso `<PID>`.                                                                                  |
|                                     | `cat /proc/<PID>/cmdline \| tr '\\0' ' '`                                    | Línea de comandos completa del proceso `<PID>` (los NULs se reemplazan por espacios).                                                          |
|                                     | `cat /proc/<PID>/environ \| tr '\\0' '\\n'`                                  | Variables de entorno del proceso `<PID>`.                                                                                                    |
|                                     | `lsof -p <PID>`                                                              | Lista archivos abiertos por el proceso `<PID>`.                                                                                               |
| **Conexiones de Red** | `ss -tulnp`                                                                  | **Preferido:** Muestra sockets TCP (`-t`), UDP (`-u`), escuchando (`-l`), numérico (`-n`), proceso (`-p`). Buscar conexiones/puertos C2, etc.   |
|                                     | `netstat -tulnp`                                                             | Comando legacy similar a `ss`. Puede no estar por defecto.                                                                                     |
|                                     | `lsof -i`                                                                    | Lista archivos/procesos asociados a conexiones de red.                                                                                        |
|                                     | `lsof -i :<puerto>`                                                            | Muestra qué proceso usa un puerto específico.                                                                                              |
| **Usuarios Logueados** | `who`                                                                        | Muestra usuarios logueados actualmente, terminal, origen (IP).                                                                                 |
|                                     | `w`                                                                          | Similar a `who`, con más detalle (qué comando ejecutan).                                                                                    |
|                                     | `last`                                                                       | Historial reciente de logins (lee `/var/log/wtmp`).                                                                                          |
|                                     | `lastb`                                                                      | Historial reciente de logins fallidos (lee `/var/log/btmp`, requiere root).                                                                 |
|                                     | `id <usuario>`                                                               | Muestra UID, GID, grupos del `<usuario>`.                                                                                                      |
|                                     | `getent passwd <usuario>`                                                    | Obtiene entrada de `/etc/passwd` para `<usuario>`.                                                                                            |
|                                     | `getent group <grupo>`                                                       | Obtiene entrada de `/etc/group` para `<grupo>`.                                                                                              |
| **Tareas Programadas (`Cron`)** | `crontab -l -u <usuario>`                                                    | Lista tareas cron del `<usuario>` (o actual si se omite).                                                                                    |
|                                     | `ls -al /etc/cron.* /etc/crontab /etc/cron.d/`                               | Lista archivos/directorios de tareas cron del sistema. Buscar scripts/comandos sospechosos.                                                   |
| **Servicios / Daemons** | `systemctl status <servicio>.service` (systemd)                                | Estado de un servicio específico.                                                                                                             |
|                                     | `systemctl list-units --type=service --state=running` (systemd)              | Lista servicios activos. Buscar servicios desconocidos/sospechosos.                                                                           |
|                                     | `service --status-all` (SysV init)                                           | Estado de servicios en sistemas más antiguos.                                                                                                |
| **Módulos del Kernel** | `lsmod`                                                                      | Lista módulos del kernel cargados. Buscar módulos extraños (rootkits).                                                                         |
|                                     | `modinfo <modulo>`                                                             | Información detallada de un `<modulo>`.                                                                                                      |
| **Sistema de Archivos Montados** | `mount` o `findmnt`                                                          | Muestra sistemas de archivos montados, opciones. Buscar montajes inesperados.                                                               |
| **Archivos Abiertos** | `lsof`                                                                       | **Muy potente:** Lista archivos abiertos (regular, red, pipe...). Útil con `-p <PID>`, `-u <usuario>`, `-i`.                                    |
| **Otros (Configuración/Caché)** | `ip addr` (o `ifconfig`)                                                     | Configuración IP.                                                                                                                            |
|                                     | `ip route` (o `route -n`)                                                      | Tabla de rutas IP.                                                                                                                             |
|                                     | `ip neigh` (o `arp -n`)                                                      | Caché ARP (IP -> MAC local).                                                                                                                   |
|                                     | `cat /etc/resolv.conf`                                                       | Servidores DNS configurados.                                                                                                                 |

## 🛠️ Herramientas Externas (Mención)

Existen herramientas más especializadas para Live Response en Linux (como UAC - UAC forensic tool, scripts personalizados, etc.), pero los comandos integrados proporcionan una gran cantidad de información inicial si se saben utilizar.

---
*Conocer estos comandos te permite obtener una imagen rápida del estado de un sistema Linux vivo durante las fases iniciales de una respuesta a incidentes.*
